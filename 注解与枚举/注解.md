### 一、定义

```
	注解(Annotation)，也称元数据。一种代码级别的说明，即用于说明程序(给计算机看)。它是JDK1.5引进的一个新特性，本质上是一个接口，该接口默认继承Annotation接口。
```

### 二、作用

#### 	1、编译检查

```
	在编译时进行格式检查 。如：@Override
```

#### 	2、文档编写

```
	在API文档中使用，通过注解对程序进行说明。(生成文档doc文档,即API文档)
```

#### 	3、代码分析

```
	通过代码里标识的注解对代码进行分析（使用到反射）
```

#### 	4、可以替代配置文件。

### 三、预定义注解

#### 	1、@Override

```
	检测被该注解标注的方法是否继承自父类(接口)的
```

#### 	2、@Deprecated

```
	该注解标注的内容，表示已过时
```

#### 	3、@SuppressWarnings

		消除警告信息,一般传递参数all，消除被注解代码的警告。  @SuppressWarnings("all")
#### 	4、使用

##### 		①@Override

```
	检查该注解标注的方法是否继承自父类(接口)。因为此类继承了Object，所以继承了Object的toString方法，所以不会报错。
```

​		![image-20200315200848731](F:\Java集合\Java全面复习\img\image-20200315200848731.png)

```
	因为Override注解是用来检查该方法是否继承自父类的，但因为toString1方法不是继承自父类的方法，所以报错了。
```

​	![image-20200315201012336](F:\Java集合\Java全面复习\img\image-20200315201012336.png)



##### 		②@Deprecated

```
	被此注解标注的方法，说明已过时了。当调用时，会出现横线划过方法的情况。
```

![image-20200315201443264](F:\Java集合\Java全面复习\img\image-20200315201443264.png)

![image-20200315201613584](F:\Java集合\Java全面复习\img\image-20200315201613584.png)

##### 		③@SuppressWarnings

```
	红色箭头指的是警告信息，可以使用@SuppressWarnings消除掉。该注解要传入参数"all"。
```

![image-20200315201750778](F:\Java集合\Java全面复习\img\image-20200315201750778.png)

```
	注解压制了程序里的所有警告了。但它自己是会有黄色警告的。
```

![image-20200315202145064](F:\Java集合\Java全面复习\img\image-20200315202145064.png)

### 四、自定义注解（第一阶段）

#### 	1、元注解

##### 			（1）定义

```
		用于描述注解的注解
```

##### 			（2）元注解分类

​					①@Target：描述注解能够作用的位置

	            此注解只有一个value属性，其返回值为枚举类型。
	            ElementType枚举类型取值：
	                TYPE：可以作用于类上
	                METHOD：可以作用于方法上
	                FIELD：可以作用于成员变量上
​					②@Retention：描述注解被保留的阶段

	            此注解只有一个value属性，其返回值为枚举类型RetentionPolicy.
	            RetentionPolicy三个取值：
	                Source
	                Class
	                RUNTIME
	            定义的注解一般用RUNTIME值。
	            @Retention(RetentionPolicy.RUNTIME)：当前被描述的注解，会保留到class字节码文件中，并被JVM读取到
​					③@Documented：描述注解是否被抽取到api文档中

​					④@Inherited：描述该注解是否被子类继承，若加入此注解，则子类会自动继承父类里边被@Inherited标注的注解.

​					⑤使用

![image-20200315211126300](F:\Java集合\Java全面复习\img\image-20200315211126300.png)

#### 	2、自定义注解

##### 			（1）格式

```
        元注解
        public @interface 注解名称{
            属性列表;
        }
```

​						 演示：							

​												自定义注解

![image-20200315203335527](F:\Java集合\Java全面复习\img\image-20200315203335527.png)

​										注解在类中使用

![image-20200315203356235](F:\Java集合\Java全面复习\img\image-20200315203356235.png)



##### 			（2）本质

```
		注解本质上就是一个接口，该接口默认继承Annotation接口
		public interface MyAnno extends java.lang.annotation.Annotation {}
```

##### 			（3）属性

###### 					①定义

```
		接口中的抽象方法，称为属性。
```

###### 					②特点

​						**I、属性返回值类型只能是以下内容**

```
			基本数据类型
			String
			枚举
			注解
			以上类型的数组
```

​								[1]演示:

```
					不是规定返回值类型里的内容，所以报错。
```

![image-20200315204038937](F:\Java集合\Java全面复习\img\image-20200315203814012.png)

​								[2]返回值演示：

![image-20200315204453101](F:\Java集合\Java全面复习\img\image-20200315204453101.png)

![image-20200315204435673](F:\Java集合\Java全面复习\img\image-20200315204435673.png)



​						**II、属性赋值**

	1. 如果定义属性时，使用default关键字给属性默认初始化值，则使用注解时，可以不进行属性的赋值。
	
	2. 如果只有一个属性需要被赋值，并且属性的名称是value，则value可以省略，直接定义值即可。
	
	3. 数组赋值时，值使用{}包裹。如果数组中只有一个值，则{}可以省略
	
	4.定义了属性，在使用时必须要给所有定义的属性赋值。否则会报错，多个值用逗号隔开。
		
​					[1]没有赋值会报错

​							定义的注解

![image-20200315204920234](F:\Java集合\Java全面复习\img\image-20200315204920234.png)

![image-20200315204810731](F:\Java集合\Java全面复习\img\image-20200315204810731.png)

​					[2]全都赋值完就不会报错了。

![image-20200315204910627](F:\Java集合\Java全面复习\img\image-20200315204910627.png)

​									s属性的返回值是一个字符串数组，但要赋的值只有一个，所以可以去掉{}。

![image-20200315205021764](F:\Java集合\Java全面复习\img\image-20200315205021764.png)

​					[3]使用default进行默认赋值

![image-20200315205214257](F:\Java集合\Java全面复习\img\image-20200315205214257.png)

​						由于注解中有了默认赋值，所以定义在类上的注解就算没有赋值，也不会报错。

![image-20200315205230953](F:\Java集合\Java全面复习\img\image-20200315205230953.png)



​					[4]由于只有一个值只用赋值。且属性名为value，则可以省略value，直接定义值即可。

![image-20200315205417552](F:\Java集合\Java全面复习\img\image-20200315205417552.png)



![image-20200315205427382](F:\Java集合\Java全面复习\img\image-20200315205427382.png)

### 五、解析注解

#### 	1、为什么要解析注解？

```
	为了获取注解中定义的属性值。可以用注解来配置，简化编写。注解大多数时候，用来代替配置文件。 
```

#### 	2、获取注解属性值的操作步骤

​			①获取注解定义的位置的对象(定义在类上Class对象，定义在方法上Method对象，定义在属性上Field对象)

​			②通过getAnnotation(Class)方法，获取指定的注解对象。

```
		这一步其实就是在内存中生成了一个实现该注解接口的子类对象。
```

​			③调用注解中的抽象方法获取配置的属性值

​	

#### 	3、具体操作

##### 		①文件列表

![image-20200315215539017](F:\Java集合\Java全面复习\img\image-20200315215539017.png)

##### 		②定义注解

![image-20200315215555221](F:\Java集合\Java全面复习\img\image-20200315215555221.png)

##### 		③定义一个类用于获取属性值

![image-20200315215439506](F:\Java集合\Java全面复习\img\image-20200315215439506.png)

##### 		④运行结果

![image-20200315215622561](F:\Java集合\Java全面复习\img\image-20200315215622561.png)



​	

```
	特别说明：解释要通过注解定义的位置的对象去获取注解对象。因为注解不是定义在类上，而用类对象的方式去获取注解对象，则会显示空指针异常。
```

![image-20200315215717369](F:\Java集合\Java全面复习\img\image-20200315215717369.png)

![image-20200315215738974](F:\Java集合\Java全面复习\img\image-20200315215738974.png)

### 六、案例：简单的测试框架

```
	需求:当主方法执行完后，会自动执行被检测到的所有方法（加了Check注解的方法），判断文件是否有异常，记录到文件中。
```

​	定义check注解:

![image-20200315223430781](F:\Java集合\Java全面复习\img\image-20200315223430781.png)

​	定义Calculator类

![image-20200315223415146](F:\Java集合\Java全面复习\img\image-20200315223415146.png)

​	定义一个TestCheck类，此类通过其他类代码里标识的注解对其代码进行分析。

![image-20200315223449727](F:\Java集合\Java全面复习\img\image-20200315223449727.png)

![image-20200315223507495](F:\Java集合\Java全面复习\img\image-20200315223507495.png)

![image-20200315224129857](F:\Java集合\Java全面复习\img\image-20200315224129857.png)

![image-20200315224204573](F:\Java集合\Java全面复习\img\image-20200315224204573.png)

![image-20200315224220229](F:\Java集合\Java全面复习\img\image-20200315224220229.png)

```
反射重要的方法
public boolean isAnnotationPresent(Class<? extends Annotation> annotationClass) :用于判断是否有对应的注解存在。参数里传的是注解的字节码文件。
```

```
通过此案例，我们知道可以通过注解对定义在注解下的代码进行分析。
```

### 七、小结

```
1. 以后大多数时候，我们会使用注解，而不是自定义注解
2. 注解给谁用？
	1. 编译器：识别注解，检测编译有没有问题.
	2. 给解析程序用，解析程序如我们上面案例的TextCheck.
3. 注解不是程序的一部分，可以理解为注解就是一个标签
```





