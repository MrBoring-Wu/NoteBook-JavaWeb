### 一、分页的思路

![](..\img\7.分页查询功能.bmp)

![](..\img\7_2.分页查询功能2.bmp)

```
Jsp：负责告诉Servlet当前的页面是第几个页面，并且告诉它每页要显示的数据。等Servlet处理完后，Servlet会转发到此页面，并且还会附带参数。JSP通过这些参数并且配合JSTL与EL将数据显示出来.那JSP怎么告诉Servlet当前是第几个页面？将参数附带到链接上.接着Servlet收到对应参数会对其进行分页处理。



Servlet：负责接受JSP的参数，并且将其封装到对象当中，好处是简化代码书写.如果JSP没有告诉当前页面是第几页面，以及要显示多少条数据，Servlet进行默认参数赋值。并且对其进行分页的处理。
```



```
	limit value1，value2：value1代表索引值，从索引是从0开始.value2代表要显示的数据条数.
```

记住一个公式：

```
		分页查询开始的索引值为 (当前页面-1)*要显示的数据条数
```

 	

### 二、复杂查询

![](..\img\复杂条件分页查询.bmp)

```
复杂查询操作建立在分页查询的基础之上，采用了模糊查询的操作。通过getParameterMap获取到封装了参数的map对象,为了简化书写。一开始查询的时候，是没有参数过去的，所以就要用到Servlet的对当前页面和显示数据条数进行默认赋值。通过三层结构第二层调用第三层进行处理，并传入map.

map遍历值，并剔除掉当前页面和要显示的数据条数的键值对。将键采用StringBuilder添加的sql语句中，并且用list集合封装值，运用集合封装的好处就是长度不限，并且可以转成数组对象，为template的传入数据对象做了铺垫。最终全部处理完后，返回到第一层的Servlet中，Servlet转发到JSP页面，

并且将参数附带过去。
```

查询注意的地方

```
	如果是传入基本类型对象获取对应的数值，则直接传入字节码文件即可，拿Integer举例，Integer.class而不是new BeanPropertyRowMapper<Integer>(Integer.class)这样会报错。
```

![image-20200228132422568](..\img\image-20200228132422568.png)



### 三、添加操作

![](..\img\3.添加功能.bmp)

### 四、删除操作

![4.删除功能](..\img\4.删除功能.bmp)

### 五、修改操作

![5.修改功能](..\img\5.修改功能.bmp)

### 六、删除选中操作

![6.删除选中功能](..\img\6.删除选中功能.bmp)

### 七、几大重要的具体操作

#### 1、防止当前页面和显示数据为空

![image-20200228135417680](..\img\image-20200228135417680.png)

#### 2、where 1=1

```
防止拼接困难，在循环遍历之中。
```

![image-20200228135459644](..\img\image-20200228135459644.png)

```
	在这里面如果没有一开始对where 1=1,则拼接时就会变成append(" where "+key+" like ?"),几次遍历后，就会变成select count(*) form user where key like ? where key like?,导致报错
```

![image-20200228135537960](..\img\image-20200228135537960.png)

```
以及这里，进行模糊查询时，不能忘记% %.
```

![image-20200228135731103](..\img\image-20200228135731103.png)

#### 3、>>溢出

```
这一步是为了防止通过>>而超过最后一页.所以如果超过最后一页了，则变成最后一页。而后面的totalPage!=0,是为了防止查不到数据时，totalPage=0，而导致currentPage=0，从而index会变成负数，而报错。
```

![image-20200228135955500](..\img\image-20200228135955500.png)

![image-20200228140147027](..\img\image-20200228140147027.png)

#### 4、<<

```
防止通过<<而变成第0页，所以如果currentPage<=0，则currentPage变成1.
```

![image-20200228140243249](..\img\image-20200228140243249.png)

#### 5、存储值![image-20200228143250120](..\img\image-20200228143250120.png)

#### 6、查询每页的公式

#### ![image-20200228143320295](..\img\image-20200228143320295.png)

#### 7、JSP<<的设置与4配合![image-20200228143419982](..\img\image-20200228143419982.png)

#### 8、显示蓝色![image-20200228143554889](..\img\image-20200228143554889.png)